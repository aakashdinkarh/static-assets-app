"use strict";(self.webpackChunkweb_repo_editor=self.webpackChunkweb_repo_editor||[]).push([[960],{893:(e,t,a)=>{a.d(t,{U2:()=>d,Ji:()=>l,QF:()=>c,eC:()=>o});var s=a(392),n=a(524);const r=()=>{const e=(0,n.Ri)(n.v$)||"";return{[n.v$]:e}};var i=a(323);const l=async e=>{const t="".concat(s.BQ.url,"?path=").concat(e),a=await fetch(t);await(0,i.L)(a);const n=(await a.json()).data.data;return Array.isArray(n)?n:[n]},o=async e=>{let{file:t,directory:a,filename:n,commitMessage:l}=e;const o=new FormData;o.append("file",t),o.append("directory",a),o.append("filename",n),o.append("commit_message",l);const c=await fetch(s.sV.url,{method:s.sV.method,headers:r(),body:o});await(0,i.L)(c);return(await c.json()).data},c=async e=>{let{path:t,content:a,commitMessage:n,sha:l}=e;const o=await fetch(s.Yl.url,{method:s.Yl.method,headers:r(),body:JSON.stringify({path:t,content:a,commitMessage:n,sha:l})});await(0,i.L)(o);return(await o.json()).data},d=async e=>{let{path:t,message:a,sha:n}=e;const l=a||"Delete ".concat(t),o=await fetch(s.c8.url,{method:s.c8.method,headers:r(),body:JSON.stringify({path:t,commitMessage:l,sha:n})});await(0,i.L)(o)}},960:(e,t,a)=>{a.r(t),a.d(t,{RepoBrowser:()=>xe});var s=a(43),n=a(56);const r="previews_loading__xtsFd",i="previews_error__48o0q",l="previews_warn__JpleS",o="previews_editActions__yhvBA",c="previews_textContentContainer__L9yeb",d="previews_textContentHeaderAndErrorContainer__Doc5e",h="previews_textContentHeader__EjvBd",m="previews_textContentPreview__CwE4f",u="previews_imagePreview__1kH7W",p="previews_unsupported__g09Nl",f="previews_downloadLink__hhrJn",v="previews_pdfViewer__A-LWv";var x=a(981),j=a(579);function _(e){let{src:t,alt:a}=e;return(0,j.jsx)(x._,{src:t,alt:a,className:u})}function w(e){let{url:t,filename:a}=e;return(0,j.jsxs)("div",{className:p,children:["This file type is not supported for preview.",(0,j.jsxs)("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:f,children:["Download ",a]})]})}var g=a(555);const y="commitDialog_input__2zHj8",b="commitDialog_errorMessage__IYQQp",N=e=>{let{isOpen:t,defaultMessage:a="",onConfirm:r,onCancel:i,errorMessage:l=""}=e;const[o,c]=(0,s.useState)(a);return(0,j.jsxs)(n.a,{isOpen:t,onClose:i,title:"Enter Commit Message",primaryActionLabel:"Save Changes",secondaryActionLabel:"Cancel",primaryActionHandler:()=>r(o),modalStyle:{minWidth:"400px"},overrideOnClose:!0,children:[(0,j.jsx)("input",{type:"text",className:y,value:o,onChange:e=>c(e.target.value),placeholder:"Enter a commit message",autoFocus:!0}),l&&(0,j.jsx)("div",{className:b,children:l})]})};var C=a(893),L=a(35);const E=(0,a(131).v)((e=>({loading:!1,setLoading:t=>e({loading:t}),isEditing:!1,setIsEditing:t=>e({isEditing:t})})));var I=a(409),S=a(60);const M="textarea_textarea__P2Lea",P=e=>{let t=Object.assign({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(e),e));return(0,j.jsx)("textarea",(0,g.A)({className:M,spellCheck:!1},t))},A="cache-control",k=e=>"GitHub caches content for ".concat(Math.floor(parseInt(e.split("=")[1])/60)," mins."),D={width:"calc(90vw - 3rem)"};function F(e){let{url:t,path:a,sha:n,contentValidation:u}=e;const[p,f]=(0,s.useState)(null),[v,x]=(0,s.useState)(null),[_,w]=(0,s.useState)(null),{loading:y,setLoading:b,isEditing:M,setIsEditing:F}=E(),{listItems:B,setListItems:R}=(0,L.N)(),{modalScreen:O,openScreen:T,closeScreen:U,setModalActionsDisabled:z}=(0,S.K)(),V=!(null===O||void 0===O||!O.includes(S.M.CommitModal)),H=()=>U(S.M.CommitModal),Q=y&&null===p,W=(0,s.useRef)(null);(0,s.useEffect)((()=>{(async()=>{try{b(!0);const e=await fetch(t);if(!e.ok)throw new Error("Failed to fetch file content");const a=await e.text();f(a),x({[A]:e.headers.get(A)})}catch(e){w({preview:e instanceof Error?e.message:"Failed to load content"})}finally{b(!1)}})()}),[f,w,b,t]);if(Q)return(0,j.jsx)("div",{className:r,children:"Loading..."});if(null!==_&&void 0!==_&&_.preview&&!p)return(0,j.jsx)("div",{className:i,children:_.preview});if(!p)return(0,j.jsx)("div",{className:i,children:"No content available"});const J=null===v||void 0===v?void 0:v[A];return(0,j.jsx)("form",{onSubmit:e=>{e.preventDefault();const t=new FormData(e.currentTarget).get("edit-content");if(t)try{null===u||void 0===u||u(t),W.current=t,w(null),T(S.M.CommitModal)}catch(a){const e=a instanceof Error?a.message:"Failed to save changes";w({validation:"Validation error: "+e})}},children:(0,j.jsxs)("div",{className:c,children:[(0,j.jsxs)("div",{className:d,children:[(0,j.jsxs)("div",{children:[J&&(0,j.jsx)("p",{className:l,children:k(J)}),(null===_||void 0===_?void 0:_.preview)&&(0,j.jsx)("p",{className:i,children:_.preview}),(null===_||void 0===_?void 0:_.validation)&&(0,j.jsx)("p",{className:i,children:_.validation})]}),(0,j.jsx)("div",{className:h,children:M?(0,j.jsxs)("div",{className:o,children:[(0,j.jsx)(I.jn,{type:"submit",children:"Save"}),(0,j.jsx)(I.tA,{onClick:()=>{F(!1),w(null)},children:"Cancel"})]}):(0,j.jsx)(I.jn,{onClick:()=>{F(!0),w(null)},children:"Edit"})})]}),M?(0,j.jsx)(P,{name:"edit-content",defaultValue:p||"",style:D}):(0,j.jsx)("pre",{className:m,children:(0,j.jsx)("code",{children:p})}),V&&(0,j.jsx)(N,{isOpen:V,defaultMessage:"Update ".concat(a),onConfirm:async e=>{if(W.current&&e.trim()){if(W.current===p)return F(!1),void H();w(null),z(!0);try{const t=await(0,C.QF)({path:a,content:W.current,commitMessage:e,sha:n});f(W.current),F(!1),(e=>{const t=B.map((t=>t.path===a?(0,g.A)((0,g.A)({},t),{},{sha:e}):t));R(t)})(t.sha),H()}catch(t){w({commit:t instanceof Error?t.message:"Failed to save changes"})}finally{z(!1)}}},onCancel:H,errorMessage:null===_||void 0===_?void 0:_.commit})]})})}function B(e){let{url:t,path:a}=e;const[n,o]=(0,s.useState)(null),[c,d]=(0,s.useState)(!0),[h,m]=(0,s.useState)(null),[u,p]=(0,s.useState)(null);if((0,s.useEffect)((()=>{(async()=>{try{d(!0);const e=await fetch(t,{headers:{Accept:"application/pdf"}});if(!e.ok)throw new Error("Failed to fetch PDF");const a=await e.blob(),s=new Blob([a],{type:"application/pdf"}),n=URL.createObjectURL(s);o(n),p({[A]:e.headers.get(A)}),m(null)}catch(e){m(e instanceof Error?e.message:"Failed to load PDF")}finally{d(!1)}})()}),[t]),(0,s.useEffect)((()=>()=>{n&&URL.revokeObjectURL(n)}),[n]),c)return(0,j.jsx)("div",{className:r,children:"Loading PDF..."});if(h)return(0,j.jsx)("div",{className:i,children:h});const f=null===u||void 0===u?void 0:u[A];return(0,j.jsxs)("div",{children:[f&&(0,j.jsx)("p",{className:l,children:k(f)}),n&&(0,j.jsx)("object",{data:n,type:"application/pdf",className:v,title:"PDF Preview: ".concat(a),children:(0,j.jsxs)("p",{children:["Your browser does not support PDF preview.",(0,j.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",children:"Click here to open the PDF"})]})})]})}const R={json:JSON.parse},O=e=>{if(T(e))return R[e.split(".").pop()]},T=e=>"LICENSE"===e||/\.(txt|md|json|html|css|js|jsx|ts|tsx|yaml|yml|xml|csv|log)$/i.test(e),U=e=>{let{previewItemPath:t}=e;const{listItems:a}=(0,L.N)(),{modalScreen:r,closeModal:i}=(0,S.K)(),{setIsEditing:l}=E(),o=!(null===r||void 0===r||!r.includes(S.M.FilePreview));if((0,s.useEffect)((()=>{o||l(!1)}),[o,l]),!o)return null;const c=a.find((e=>e.path===t));return(0,j.jsx)(n.a,{isOpen:o,onClose:i,title:c.name,primaryActionLabel:"Save Changes",secondaryActionLabel:"Cancel",primaryActionHandler:()=>{},modalStyle:{maxWidth:"90vw"},showFooter:!1,children:(()=>{return e=c.name,/\.(jpg|jpeg|png|gif|svg|webp)$/i.test(e)?(0,j.jsx)(_,{src:c.download_url,alt:c.name}):(e=>/\.(pdf)$/i.test(e))(c.name)?(0,j.jsx)(B,{url:c.download_url,path:c.path}):T(c.name)?(0,j.jsx)(F,{url:c.download_url,path:c.path,sha:c.sha,contentValidation:O(c.name)}):(0,j.jsx)(w,{url:c.download_url,filename:c.name});var e})()})};var z=a(467);const V="/",H={breadcrumb:"breadcrumb_breadcrumb__WeMsB",breadcrumbSeparator:"breadcrumb_breadcrumbSeparator__TaR28"};function Q(e){let{currentPath:t,onNavigate:a}=e;const n=t.split("/").filter(Boolean);return 0===n.length?null:(0,j.jsxs)("div",{className:H.breadcrumb,children:[(0,j.jsx)(z.vx,{onClick:()=>a(V),children:"root"}),n.map(((e,t)=>(0,j.jsxs)(s.Fragment,{children:[(0,j.jsx)("span",{className:H.breadcrumbSeparator,children:"/"}),(0,j.jsx)(z.vx,{onClick:()=>a(n.slice(0,t+1).join("/")),children:e})]},e)))]})}var W=a(191);const J=()=>window.innerWidth<=768,K=()=>{const[e,t]=(0,s.useState)(J());return(0,s.useEffect)((()=>{const e=()=>{t(J())};e();const a=((e,t)=>{let a;return()=>{clearTimeout(a),a=setTimeout(e,t)}})(e,100);return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)}),[]),e};var Y=a(813);const $={container:"RepoBrowser_container__szVdA",header:"RepoBrowser_header__xCXIr",branchName:"RepoBrowser_branchName__Rh8Kw",refreshButton:"RepoBrowser_refreshButton__rgcju"},G=e=>{let{handleRefresh:t}=e;const{isLoading:a,branch:s}=(0,L.N)(),n=()=>{window.open((0,Y.wS)(s),"_blank")};return K()?(0,j.jsxs)("h2",{className:$.header,children:["Repository Browser"," ",(0,j.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[s&&(0,j.jsx)(j.Fragment,{children:(0,j.jsxs)(z.tA,{className:$.branchName,onClick:n,children:[(0,j.jsx)(x._,{src:W.UM,alt:"git branch"}),s]})}),(0,j.jsx)(z.tA,{disabled:a,className:$.refreshButton,onClick:t,children:"\ud83d\udd04"})]})]}):(0,j.jsxs)("h2",{className:$.header,children:["Repository Browser"," ",s&&(0,j.jsx)(j.Fragment,{children:(0,j.jsxs)(z.tA,{className:$.branchName,onClick:n,children:[(0,j.jsx)(x._,{src:W.UM,alt:"git branch"}),s]})}),(0,j.jsx)(z.tA,{disabled:a,className:$.refreshButton,onClick:t,children:"\ud83d\udd04"})]})},Z=e=>{delete Y.PP[e]};var q=a(833);const X=()=>{const{currentPath:e,setListItems:t,setIsLoading:a,setError:n}=(0,L.N)(),r=!!(0,q.useGithubUserInfoStore)().userInfo,{setModalActionsDisabled:i}=(0,S.K)(),l=(0,s.useCallback)((async function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=(e=>{const t=Y.PP[e];return t?Date.now()-t.timestamp>Y.bY?(Z(e),null):t.data:null})(e);if(!r||s){a(!0),n(null);try{const a=s?"".concat(e,"&refresh=true"):e,n=await(0,C.Ji)(a);((e,t)=>{Y.PP[e]={data:t,timestamp:Date.now()}})(e,n),t(n)}catch(i){n(i instanceof Error?i.message:"An error occurred")}finally{a(!1)}}else t(r)}),[n,a,t]),o=(0,s.useCallback)((async t=>{try{i(!0),await(0,C.U2)({path:t.path,message:"Delete ".concat(t.name," from ").concat(e),sha:t.sha}),Z(e),l(e)}catch(a){n(a instanceof Error?a.message:"Failed to delete item")}finally{i(!1)}}),[e,l,n,i]),c=(0,s.useCallback)((()=>{Z(e),l(e,!0)}),[e,l]);return(0,s.useEffect)((()=>{l(e)}),[e,l,r]),{handleDelete:o,handleRefresh:c}};var ee=a(316),te=a(168);const ae=e=>{let{onConfirm:t,title:a,message:s}=e;const{modalScreen:n}=(0,S.K)(),r=n===S.M.ConfirmationModal;return(0,j.jsx)(ee.a,{isOpen:r,title:a,primaryActionLabel:"DELETE",secondaryActionLabel:"Close",primaryActionHandler:t,primaryActionType:te.V.Danger,children:s})},se=[{path:"LICENSE",type:"file"},{path:"README.md",type:"file"},{path:"files",type:"dir"},{path:"images",type:"dir"},{path:"index.html",type:"file"},{path:"sounds",type:"dir"}];var ne=a(394);const re="repoListItems_itemList__nAQwV",ie="repoListItems_item__CTZBT",le="repoListItems_loadingList__N+dUc",oe="repoListItems_itemName__BvflF",ce="repoListItems_itemNameText__76sCQ",de="repoListItems_fileSize__mZI8g",he="repoListItems_actions__Wy8oe",me={minHeight:"31.5px",minWidth:"29.95px"},ue=e=>{let{loaderListItems:t}=e;return(0,j.jsx)("div",{className:(0,ne.z)(re,le),children:t.map((e=>(0,j.jsxs)("div",{className:ie,children:[(0,j.jsx)("div",{className:oe,children:"dir"===e.type?"\ud83d\udcc1 ":"\ud83d\udcc4 "}),"file"===e.type&&(0,j.jsx)("div",{className:he,children:(0,j.jsx)(z.Qi,{disabled:!0,style:me})})]},e.path)))})},pe=e=>{let{setPreviewItemPath:t,setDeleteItemPath:a}=e;const{listItems:n,isLoading:r,setCurrentPath:i}=(0,L.N)(),{openModal:l}=(0,S.K)(),o=(0,s.useMemo)((()=>n.length?n:se),[n.length]);return r?(0,j.jsx)(ue,{loaderListItems:o}):(0,j.jsx)("div",{className:re,children:n.map((e=>(0,j.jsxs)("div",{className:ie,children:[(0,j.jsxs)("div",{className:oe,onClick:()=>(e=>{"dir"===e.type?i(e.path):(t(e.path),l([S.M.FilePreview]))})(e),role:"button",tabIndex:0,children:["dir"===e.type?"\ud83d\udcc1 ":"\ud83d\udcc4 ",(0,j.jsx)("div",{className:ce,children:e.name}),"file"===e.type&&e.size&&(0,j.jsxs)("span",{className:de,children:["(",(e.size/1024).toFixed(1)," KB)"]})]}),"file"===e.type&&(0,j.jsx)("div",{className:he,children:(0,j.jsx)(z.Qi,{onClick:()=>{return t=e.path,a(t),void l(S.M.ConfirmationModal);var t},children:(0,j.jsx)(x._,{height:15.5,src:W.Mz,alt:"dustbin"})})})]},e.path)))})},fe=e=>{let{deleteItemPath:t,handleDelete:a}=e;const{listItems:s}=(0,L.N)(),n=s.find((e=>e.path===t));if(!n)return null;const r=(0,j.jsxs)("span",{style:{wordBreak:"break-all"},children:["Are you sure you want to delete ",(0,j.jsx)("strong",{children:t}),"?"]});return(0,j.jsx)(ae,{title:"Delete Item",message:r,onConfirm:()=>a(n)})},ve=(0,s.lazy)((()=>a.e(594).then(a.bind(a,594)).then((e=>({default:e.Error})))));function xe(){const[e,t]=(0,s.useState)(null),[a,n]=(0,s.useState)(null),{handleDelete:r,handleRefresh:i}=X(),{error:l,currentPath:o,setCurrentPath:c}=(0,L.N)();return(0,j.jsxs)("div",{className:$.container,children:[(0,j.jsx)(G,{handleRefresh:i}),(0,j.jsx)(Q,{currentPath:o,onNavigate:c}),l?(0,j.jsx)(s.Suspense,{fallback:(0,j.jsx)("div",{children:"Loading..."}),children:(0,j.jsx)(ve,{error:l})}):(0,j.jsx)(pe,{setPreviewItemPath:t,setDeleteItemPath:n}),e&&(0,j.jsx)(U,{previewItemPath:e}),a&&(0,j.jsx)(fe,{deleteItemPath:a,handleDelete:r})]})}}}]);