"use strict";(self.webpackChunkstatic_assets_app=self.webpackChunkstatic_assets_app||[]).push([[916],{893:(e,t,a)=>{a.d(t,{U2:()=>c,Ji:()=>i,QF:()=>o,eC:()=>l});var s=a(392),n=a(524);const r=()=>{const e=(0,n.Ri)(n.v$)||"";return{[n.v$]:e}},i=async e=>{const t="".concat(s.BQ.url,"?path=").concat(e),a=await fetch(t);if(!a.ok)throw new Error("Failed to fetch repository contents");const n=(await a.json()).data.data;return Array.isArray(n)?n:[n]},l=async e=>{let{file:t,directory:a,filename:n,commitMessage:i}=e;const l=new FormData;l.append("file",t),l.append("directory",a),l.append("filename",n),l.append("commit_message",i);const o=await fetch(s.sV.url,{method:s.sV.method,headers:r(),body:l});if(!o.ok)throw new Error("Failed to upload content");return(await o.json()).data},o=async e=>{let{path:t,content:a,commitMessage:n,sha:i}=e;const l=await fetch(s.Yl.url,{method:s.Yl.method,headers:r(),body:JSON.stringify({path:t,content:a,commitMessage:n,sha:i})});if(!l.ok)throw new Error("Failed to update content");return(await l.json()).data},c=async e=>{let{path:t,message:a,sha:n}=e;const i=a||"Delete ".concat(t);if(!(await fetch(s.c8.url,{method:s.c8.method,headers:r(),body:JSON.stringify({path:t,commitMessage:i,sha:n})})).ok)throw new Error("Failed to delete item")}},916:(e,t,a)=>{a.r(t),a.d(t,{RepoBrowser:()=>re});var s=a(43);const n="previews_loading__xtsFd",r="previews_error__48o0q",i="previews_editActions__yhvBA",l="previews_textContentContainer__L9yeb",o="previews_textContentHeaderAndErrorContainer__Doc5e",c="previews_textContentHeader__EjvBd",d="previews_textContentPreview__CwE4f",m="previews_imagePreview__1kH7W",h="previews_unsupported__g09Nl",u="previews_downloadLink__hhrJn";var p=a(981),v=a(579);function f(e){let{src:t,alt:a}=e;return(0,v.jsx)(p._,{src:t,alt:a,className:m})}function _(e){let{url:t,filename:a}=e;return(0,v.jsxs)("div",{className:h,children:["This file type is not supported for preview.",(0,v.jsxs)("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:u,children:["Download ",a]})]})}var x=a(555);const g="commitDialog_input__2zHj8",w="commitDialog_errorMessage__IYQQp";var j=a(56);const y=e=>{let{isOpen:t,defaultMessage:a="",onConfirm:n,onCancel:r,errorMessage:i=""}=e;const[l,o]=(0,s.useState)(a);return(0,v.jsxs)(j.a,{isOpen:t,onClose:r,title:"Enter Commit Message",primaryActionLabel:"Save Changes",secondaryActionLabel:"Cancel",primaryActionHandler:()=>n(l),modalStyle:{minWidth:"400px"},overrideOnClose:!0,children:[(0,v.jsx)("input",{type:"text",className:g,value:l,onChange:e=>o(e.target.value),placeholder:"Enter a commit message",autoFocus:!0}),i&&(0,v.jsx)("div",{className:w,children:i})]})};var C=a(893),b=a(131);const N=(0,b.v)((e=>({currentPath:"/",setCurrentPath:t=>e({currentPath:t}),listItems:[],setListItems:t=>e({listItems:t}),isLoading:!1,setIsLoading:t=>e({isLoading:t}),error:null,setError:t=>e({error:t})}))),I=(0,b.v)((e=>({loading:!1,setLoading:t=>e({loading:t}),isEditing:!1,setIsEditing:t=>e({isEditing:t})})));var E=a(409),L=a(60);const M="textarea_textarea__P2Lea",P=e=>{let t=Object.assign({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(e),e));return(0,v.jsx)("textarea",(0,x.A)({className:M,spellCheck:!1},t))},A={width:"calc(90vw - 3rem)"};function k(e){let{url:t,path:a,sha:m,contentValidation:h}=e;const[u,p]=(0,s.useState)(null),[f,_]=(0,s.useState)(null),{loading:g,setLoading:w,isEditing:j,setIsEditing:b}=I(),{listItems:M,setListItems:k}=N(),{modalScreen:S,openScreen:D,closeScreen:F,setModalActionsDisabled:B}=(0,L.K)(),R=!(null===S||void 0===S||!S.includes(L.M.CommitModal)),O=()=>F(L.M.CommitModal),V=g&&null===u,H=(0,s.useRef)(null);(0,s.useEffect)((()=>{(async()=>{try{w(!0);const e=await fetch(t);if(!e.ok)throw new Error("Failed to fetch file content");const a=await e.text();p(a)}catch(e){_({preview:e instanceof Error?e.message:"Failed to load content"})}finally{w(!1)}})()}),[p,_,w,t]);return V?(0,v.jsx)("div",{className:n,children:"Loading..."}):null!==f&&void 0!==f&&f.preview&&!u?(0,v.jsx)("div",{className:r,children:f.preview}):u?(0,v.jsx)("form",{onSubmit:e=>{e.preventDefault();const t=new FormData(e.currentTarget).get("edit-content");if(t)try{null===h||void 0===h||h(t),H.current=t,_(null),D(L.M.CommitModal)}catch(a){const e=a instanceof Error?a.message:"Failed to save changes";_({commit:"Validation error: "+e})}},children:(0,v.jsxs)("div",{className:l,children:[(0,v.jsxs)("div",{className:o,children:[(null===f||void 0===f?void 0:f.preview)&&(0,v.jsx)("div",{className:r,children:f.preview}),(0,v.jsx)("div",{className:c,children:j?(0,v.jsxs)("div",{className:i,children:[(0,v.jsx)(E.jn,{type:"submit",children:"Save"}),(0,v.jsx)(E.tA,{onClick:()=>{b(!1),_(null)},children:"Cancel"})]}):(0,v.jsx)(E.jn,{onClick:()=>{b(!0),_(null)},children:"Edit"})})]}),j?(0,v.jsx)(P,{name:"edit-content",defaultValue:u||"",style:A}):(0,v.jsx)("pre",{className:d,children:(0,v.jsx)("code",{children:u})}),R&&(0,v.jsx)(y,{isOpen:R,defaultMessage:"Update ".concat(a),onConfirm:async e=>{if(H.current&&e.trim()){if(H.current===u)return b(!1),void O();_(null),B(!0);try{const t=await(0,C.QF)({path:a,content:H.current,commitMessage:e,sha:m});p(H.current),b(!1),(e=>{const t=M.map((t=>t.path===a?(0,x.A)((0,x.A)({},t),{},{sha:e}):t));k(t)})(t.sha),O()}catch(t){_({commit:t instanceof Error?t.message:"Failed to save changes"})}finally{B(!1)}}},onCancel:O,errorMessage:null===f||void 0===f?void 0:f.commit})]})}):(0,v.jsx)("div",{className:r,children:"No content available"})}const S=e=>{let{previewItemPath:t}=e;const{listItems:a}=N(),{modalScreen:n,closeModal:r}=(0,L.K)(),{setIsEditing:i}=I(),l=!(null===n||void 0===n||!n.includes(L.M.FilePreview));if((0,s.useEffect)((()=>{l||i(!1)}),[l,i]),!l)return null;const o=a.find((e=>e.path===t));return(0,v.jsx)(j.a,{isOpen:l,onClose:r,title:o.name,primaryActionLabel:"Save Changes",secondaryActionLabel:"Cancel",primaryActionHandler:()=>{},modalStyle:{maxWidth:"90vw"},showFooter:!1,children:(()=>{return e=o.name,/\.(jpg|jpeg|png|gif|svg|webp)$/i.test(e)?(0,v.jsx)(f,{src:o.download_url,alt:o.name}):(e=>e.endsWith(".json"))(o.name)?(0,v.jsx)(k,{url:o.download_url,path:o.path,sha:o.sha,contentValidation:e=>JSON.parse(e)}):(e=>e.endsWith(".html"))(o.name)?(0,v.jsx)(k,{url:o.download_url,path:o.path,sha:o.sha}):(0,v.jsx)(_,{url:o.download_url,filename:o.name});var e})()})};var D=a(467);const F="/",B={breadcrumb:"breadcrumb_breadcrumb__WeMsB",breadcrumbSeparator:"breadcrumb_breadcrumbSeparator__TaR28"};function R(e){let{currentPath:t,onNavigate:a}=e;const n=t.split("/").filter(Boolean);return 0===n.length?null:(0,v.jsxs)("div",{className:B.breadcrumb,children:[(0,v.jsx)(D.vx,{onClick:()=>a(F),children:"root"}),n.map(((e,t)=>(0,v.jsxs)(s.Fragment,{children:[(0,v.jsx)("span",{className:B.breadcrumbSeparator,children:"/"}),(0,v.jsx)(D.vx,{onClick:()=>a(n.slice(0,t+1).join("/")),children:e})]},e)))]})}var O=a(813);const V=e=>{delete O.PP[e]};var H=a(833);const Q=()=>{const{currentPath:e,setListItems:t,setIsLoading:a,setError:n}=N(),r=!!(0,H.r)().userInfo,{setModalActionsDisabled:i}=(0,L.K)(),l=(0,s.useCallback)((async function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=(e=>{const t=O.PP[e];return t?Date.now()-t.timestamp>O.bY?(V(e),null):t.data:null})(e);if(!r||s){a(!0),n(null);try{const a=s?"".concat(e,"&refresh=true"):e,n=await(0,C.Ji)(a);((e,t)=>{O.PP[e]={data:t,timestamp:Date.now()}})(e,n),t(n)}catch(i){n(i instanceof Error?i.message:"An error occurred")}finally{a(!1)}}else t(r)}),[n,a,t]),o=(0,s.useCallback)((async t=>{try{i(!0),await(0,C.U2)({path:t.path,message:"Delete ".concat(t.name," from ").concat(e),sha:t.sha}),V(e),l(e)}catch(a){n(a instanceof Error?a.message:"Failed to delete item")}finally{i(!1)}}),[e,l,n,i]),c=(0,s.useCallback)((()=>{V(e),l(e,!0)}),[e,l]);return(0,s.useEffect)((()=>{l(e)}),[e,l,r]),{handleDelete:o,handleRefresh:c}};var T=a(316),W=a(168);const z=e=>{let{onConfirm:t,title:a,message:s}=e;const{modalScreen:n}=(0,L.K)(),r=n===L.M.ConfirmationModal;return(0,v.jsx)(T.a,{isOpen:r,title:a,primaryActionLabel:"DELETE",secondaryActionLabel:"Close",primaryActionHandler:t,primaryActionType:W.V.Danger,children:s})},J=[{path:"LICENSE",type:"file"},{path:"README.md",type:"file"},{path:"files",type:"dir"},{path:"images",type:"dir"},{path:"index.html",type:"file"},{path:"sounds",type:"dir"}];var K=a(394);const U="repoListItems_itemList__nAQwV",Y="repoListItems_item__CTZBT",$="repoListItems_loadingList__N+dUc",Z="repoListItems_itemName__BvflF",q="repoListItems_fileSize__mZI8g",X="repoListItems_actions__Wy8oe",G={minHeight:"31.5px",minWidth:"70.5px"},ee=e=>{let{loaderListItems:t}=e;return(0,v.jsx)("div",{className:(0,K.z)(U,$),children:t.map((e=>(0,v.jsxs)("div",{className:Y,children:[(0,v.jsx)("div",{className:Z,children:"dir"===e.type?"\ud83d\udcc1 ":"\ud83d\udcc4 "}),"file"===e.type&&(0,v.jsx)("div",{className:X,children:(0,v.jsx)(D.Qi,{disabled:!0,style:G})})]},e.path)))})},te=e=>{let{setPreviewItemPath:t,setDeleteItemPath:a}=e;const{listItems:n,isLoading:r,setCurrentPath:i}=N(),{openModal:l}=(0,L.K)(),o=(0,s.useMemo)((()=>n.length?n:J),[n.length]);return r?(0,v.jsx)(ee,{loaderListItems:o}):(0,v.jsx)("div",{className:U,children:n.map((e=>(0,v.jsxs)("div",{className:Y,children:[(0,v.jsxs)("div",{className:Z,onClick:()=>(e=>{"dir"===e.type?i(e.path):(t(e.path),l([L.M.FilePreview]))})(e),role:"button",tabIndex:0,children:["dir"===e.type?"\ud83d\udcc1 ":"\ud83d\udcc4 ",e.name,"file"===e.type&&e.size&&(0,v.jsxs)("span",{className:q,children:["(",(e.size/1024).toFixed(1)," KB)"]})]}),"file"===e.type&&(0,v.jsx)("div",{className:X,children:(0,v.jsx)(D.Qi,{onClick:()=>{return t=e.path,a(t),void l(L.M.ConfirmationModal);var t},children:"Delete"})})]},e.path)))})},ae=e=>{let{deleteItemPath:t,handleDelete:a}=e;const{listItems:s}=N(),n=s.find((e=>e.path===t));if(!n)return null;const r=(0,v.jsxs)("span",{style:{wordBreak:"break-all"},children:["Are you sure you want to delete ",(0,v.jsx)("strong",{children:t}),"?"]});return(0,v.jsx)(z,{title:"Delete Item",message:r,onConfirm:()=>a(n)})},se={container:"RepoBrowser_container__szVdA",header:"RepoBrowser_header__xCXIr",refreshButton:"RepoBrowser_refreshButton__rgcju"},ne=(0,s.lazy)((()=>a.e(594).then(a.bind(a,594)).then((e=>({default:e.Error})))));function re(){const[e,t]=(0,s.useState)(null),[a,n]=(0,s.useState)(null),{handleRefresh:r,handleDelete:i}=Q(),{isLoading:l,error:o,currentPath:c,setCurrentPath:d}=N();return(0,v.jsxs)("div",{className:se.container,children:[(0,v.jsxs)("div",{className:se.header,children:[(0,v.jsxs)("h1",{children:["Repository Browser"," ",(0,v.jsx)(D.tA,{disabled:l,className:se.refreshButton,onClick:r,children:"\ud83d\udd04"})]}),(0,v.jsx)(R,{currentPath:c,onNavigate:d})]}),o?(0,v.jsx)(s.Suspense,{fallback:(0,v.jsx)("div",{children:"Loading..."}),children:(0,v.jsx)(ne,{error:o})}):(0,v.jsx)(te,{setPreviewItemPath:t,setDeleteItemPath:n}),e&&(0,v.jsx)(S,{previewItemPath:e}),a&&(0,v.jsx)(ae,{deleteItemPath:a,handleDelete:i})]})}}}]);
//# sourceMappingURL=916.1d373325.chunk.js.map