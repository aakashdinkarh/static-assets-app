"use strict";(self.webpackChunkstatic_assets_app=self.webpackChunkstatic_assets_app||[]).push([[209],{209:(e,t,a)=>{a.r(t),a.d(t,{RepoBrowser:()=>ie});var s=a(43);const n="previews_loading__xtsFd",r="previews_error__48o0q",i="previews_editActions__yhvBA",l="previews_textContentContainer__L9yeb",o="previews_textContentHeaderAndErrorContainer__Doc5e",c="previews_textContentHeader__EjvBd",d="previews_textContentPreview__CwE4f",h="previews_imagePreview__1kH7W",m="previews_unsupported__g09Nl",p="previews_downloadLink__hhrJn";var u=a(981),v=a(579);function f(e){let{src:t,alt:a}=e;return(0,v.jsx)(u._,{src:t,alt:a,className:h})}function _(e){let{url:t,filename:a}=e;return(0,v.jsxs)("div",{className:m,children:["This file type is not supported for preview.",(0,v.jsxs)("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:p,children:["Download ",a]})]})}var x=a(555);const g="commitDialog_input__2zHj8",j="commitDialog_errorMessage__IYQQp";var w=a(56);const y=e=>{let{isOpen:t,defaultMessage:a="",onConfirm:n,onCancel:r,errorMessage:i=""}=e;const[l,o]=(0,s.useState)(a);return(0,v.jsxs)(w.a,{isOpen:t,onClose:r,title:"Enter Commit Message",primaryActionLabel:"Save Changes",secondaryActionLabel:"Cancel",primaryActionHandler:()=>n(l),modalStyle:{minWidth:"400px"},overrideOnClose:!0,children:[(0,v.jsx)("input",{type:"text",className:g,value:l,onChange:e=>o(e.target.value),placeholder:"Enter a commit message",autoFocus:!0}),i&&(0,v.jsx)("div",{className:j,children:i})]})};var b=a(893),N=a(35);const C=(0,a(131).v)((e=>({loading:!1,setLoading:t=>e({loading:t}),isEditing:!1,setIsEditing:t=>e({isEditing:t})})));var L=a(409),I=a(60);const E="textarea_textarea__P2Lea",M=e=>{let t=Object.assign({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(e),e));return(0,v.jsx)("textarea",(0,x.A)({className:E,spellCheck:!1},t))},A={width:"calc(90vw - 3rem)"};function P(e){let{url:t,path:a,sha:h,contentValidation:m}=e;const[p,u]=(0,s.useState)(null),[f,_]=(0,s.useState)(null),{loading:g,setLoading:j,isEditing:w,setIsEditing:E}=C(),{listItems:P,setListItems:S}=(0,N.N)(),{modalScreen:D,openScreen:k,closeScreen:B,setModalActionsDisabled:F}=(0,I.K)(),R=!(null===D||void 0===D||!D.includes(I.M.CommitModal)),O=()=>B(I.M.CommitModal),V=g&&null===p,H=(0,s.useRef)(null);(0,s.useEffect)((()=>{(async()=>{try{j(!0);const e=await fetch(t);if(!e.ok)throw new Error("Failed to fetch file content");const a=await e.text();u(a)}catch(e){_({preview:e instanceof Error?e.message:"Failed to load content"})}finally{j(!1)}})()}),[u,_,j,t]);return V?(0,v.jsx)("div",{className:n,children:"Loading..."}):null!==f&&void 0!==f&&f.preview&&!p?(0,v.jsx)("div",{className:r,children:f.preview}):p?(0,v.jsx)("form",{onSubmit:e=>{e.preventDefault();const t=new FormData(e.currentTarget).get("edit-content");if(t)try{null===m||void 0===m||m(t),H.current=t,_(null),k(I.M.CommitModal)}catch(a){const e=a instanceof Error?a.message:"Failed to save changes";_({commit:"Validation error: "+e})}},children:(0,v.jsxs)("div",{className:l,children:[(0,v.jsxs)("div",{className:o,children:[(null===f||void 0===f?void 0:f.preview)&&(0,v.jsx)("div",{className:r,children:f.preview}),(0,v.jsx)("div",{className:c,children:w?(0,v.jsxs)("div",{className:i,children:[(0,v.jsx)(L.jn,{type:"submit",children:"Save"}),(0,v.jsx)(L.tA,{onClick:()=>{E(!1),_(null)},children:"Cancel"})]}):(0,v.jsx)(L.jn,{onClick:()=>{E(!0),_(null)},children:"Edit"})})]}),w?(0,v.jsx)(M,{name:"edit-content",defaultValue:p||"",style:A}):(0,v.jsx)("pre",{className:d,children:(0,v.jsx)("code",{children:p})}),R&&(0,v.jsx)(y,{isOpen:R,defaultMessage:"Update ".concat(a),onConfirm:async e=>{if(H.current&&e.trim()){if(H.current===p)return E(!1),void O();_(null),F(!0);try{const t=await(0,b.QF)({path:a,content:H.current,commitMessage:e,sha:h});u(H.current),E(!1),(e=>{const t=P.map((t=>t.path===a?(0,x.A)((0,x.A)({},t),{},{sha:e}):t));S(t)})(t.sha),O()}catch(t){_({commit:t instanceof Error?t.message:"Failed to save changes"})}finally{F(!1)}}},onCancel:O,errorMessage:null===f||void 0===f?void 0:f.commit})]})}):(0,v.jsx)("div",{className:r,children:"No content available"})}const S=e=>{let{previewItemPath:t}=e;const{listItems:a}=(0,N.N)(),{modalScreen:n,closeModal:r}=(0,I.K)(),{setIsEditing:i}=C(),l=!(null===n||void 0===n||!n.includes(I.M.FilePreview));if((0,s.useEffect)((()=>{l||i(!1)}),[l,i]),!l)return null;const o=a.find((e=>e.path===t));return(0,v.jsx)(w.a,{isOpen:l,onClose:r,title:o.name,primaryActionLabel:"Save Changes",secondaryActionLabel:"Cancel",primaryActionHandler:()=>{},modalStyle:{maxWidth:"90vw"},showFooter:!1,children:(()=>{return e=o.name,/\.(jpg|jpeg|png|gif|svg|webp)$/i.test(e)?(0,v.jsx)(f,{src:o.download_url,alt:o.name}):(e=>e.endsWith(".json"))(o.name)?(0,v.jsx)(P,{url:o.download_url,path:o.path,sha:o.sha,contentValidation:e=>JSON.parse(e)}):(e=>e.endsWith(".html"))(o.name)?(0,v.jsx)(P,{url:o.download_url,path:o.path,sha:o.sha}):(0,v.jsx)(_,{url:o.download_url,filename:o.name});var e})()})};var D=a(467);const k="/",B={breadcrumb:"breadcrumb_breadcrumb__WeMsB",breadcrumbSeparator:"breadcrumb_breadcrumbSeparator__TaR28"};function F(e){let{currentPath:t,onNavigate:a}=e;const n=t.split("/").filter(Boolean);return 0===n.length?null:(0,v.jsxs)("div",{className:B.breadcrumb,children:[(0,v.jsx)(D.vx,{onClick:()=>a(k),children:"root"}),n.map(((e,t)=>(0,v.jsxs)(s.Fragment,{children:[(0,v.jsx)("span",{className:B.breadcrumbSeparator,children:"/"}),(0,v.jsx)(D.vx,{onClick:()=>a(n.slice(0,t+1).join("/")),children:e})]},e)))]})}var R=a(191);const O={container:"RepoBrowser_container__szVdA",header:"RepoBrowser_header__xCXIr",branchName:"RepoBrowser_branchName__Rh8Kw",refreshButton:"RepoBrowser_refreshButton__rgcju"},V=e=>{let{handleRefresh:t}=e;const{isLoading:a,branch:s}=(0,N.N)();return(0,v.jsxs)("h1",{className:O.header,children:["Repository Browser"," ",s&&(0,v.jsx)(v.Fragment,{children:(0,v.jsxs)(D.tA,{className:O.branchName,children:[(0,v.jsx)(u._,{src:R.U,alt:"git branch"}),s]})}),(0,v.jsx)(D.tA,{disabled:a,className:O.refreshButton,onClick:t,children:"\ud83d\udd04"})]})};var H=a(813);const Q=e=>{delete H.PP[e]};var T=a(833);const W=()=>{const{currentPath:e,setListItems:t,setIsLoading:a,setError:n}=(0,N.N)(),r=!!(0,T.r)().userInfo,{setModalActionsDisabled:i}=(0,I.K)(),l=(0,s.useCallback)((async function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=(e=>{const t=H.PP[e];return t?Date.now()-t.timestamp>H.bY?(Q(e),null):t.data:null})(e);if(!r||s){a(!0),n(null);try{const a=s?"".concat(e,"&refresh=true"):e,n=await(0,b.Ji)(a);((e,t)=>{H.PP[e]={data:t,timestamp:Date.now()}})(e,n),t(n)}catch(i){n(i instanceof Error?i.message:"An error occurred")}finally{a(!1)}}else t(r)}),[n,a,t]),o=(0,s.useCallback)((async t=>{try{i(!0),await(0,b.U2)({path:t.path,message:"Delete ".concat(t.name," from ").concat(e),sha:t.sha}),Q(e),l(e)}catch(a){n(a instanceof Error?a.message:"Failed to delete item")}finally{i(!1)}}),[e,l,n,i]),c=(0,s.useCallback)((()=>{Q(e),l(e,!0)}),[e,l]);return(0,s.useEffect)((()=>{l(e)}),[e,l,r]),{handleDelete:o,handleRefresh:c}};var z=a(316),K=a(168);const J=e=>{let{onConfirm:t,title:a,message:s}=e;const{modalScreen:n}=(0,I.K)(),r=n===I.M.ConfirmationModal;return(0,v.jsx)(z.a,{isOpen:r,title:a,primaryActionLabel:"DELETE",secondaryActionLabel:"Close",primaryActionHandler:t,primaryActionType:K.V.Danger,children:s})},U=[{path:"LICENSE",type:"file"},{path:"README.md",type:"file"},{path:"files",type:"dir"},{path:"images",type:"dir"},{path:"index.html",type:"file"},{path:"sounds",type:"dir"}];var Y=a(394);const $="repoListItems_itemList__nAQwV",Z="repoListItems_item__CTZBT",q="repoListItems_loadingList__N+dUc",X="repoListItems_itemName__BvflF",G="repoListItems_fileSize__mZI8g",ee="repoListItems_actions__Wy8oe",te={minHeight:"31.5px",minWidth:"70.5px"},ae=e=>{let{loaderListItems:t}=e;return(0,v.jsx)("div",{className:(0,Y.z)($,q),children:t.map((e=>(0,v.jsxs)("div",{className:Z,children:[(0,v.jsx)("div",{className:X,children:"dir"===e.type?"\ud83d\udcc1 ":"\ud83d\udcc4 "}),"file"===e.type&&(0,v.jsx)("div",{className:ee,children:(0,v.jsx)(D.Qi,{disabled:!0,style:te})})]},e.path)))})},se=e=>{let{setPreviewItemPath:t,setDeleteItemPath:a}=e;const{listItems:n,isLoading:r,setCurrentPath:i}=(0,N.N)(),{openModal:l}=(0,I.K)(),o=(0,s.useMemo)((()=>n.length?n:U),[n.length]);return r?(0,v.jsx)(ae,{loaderListItems:o}):(0,v.jsx)("div",{className:$,children:n.map((e=>(0,v.jsxs)("div",{className:Z,children:[(0,v.jsxs)("div",{className:X,onClick:()=>(e=>{"dir"===e.type?i(e.path):(t(e.path),l([I.M.FilePreview]))})(e),role:"button",tabIndex:0,children:["dir"===e.type?"\ud83d\udcc1 ":"\ud83d\udcc4 ",e.name,"file"===e.type&&e.size&&(0,v.jsxs)("span",{className:G,children:["(",(e.size/1024).toFixed(1)," KB)"]})]}),"file"===e.type&&(0,v.jsx)("div",{className:ee,children:(0,v.jsx)(D.Qi,{onClick:()=>{return t=e.path,a(t),void l(I.M.ConfirmationModal);var t},children:"Delete"})})]},e.path)))})},ne=e=>{let{deleteItemPath:t,handleDelete:a}=e;const{listItems:s}=(0,N.N)(),n=s.find((e=>e.path===t));if(!n)return null;const r=(0,v.jsxs)("span",{style:{wordBreak:"break-all"},children:["Are you sure you want to delete ",(0,v.jsx)("strong",{children:t}),"?"]});return(0,v.jsx)(J,{title:"Delete Item",message:r,onConfirm:()=>a(n)})},re=(0,s.lazy)((()=>a.e(594).then(a.bind(a,594)).then((e=>({default:e.Error})))));function ie(){const[e,t]=(0,s.useState)(null),[a,n]=(0,s.useState)(null),{handleDelete:r,handleRefresh:i}=W(),{error:l,currentPath:o,setCurrentPath:c}=(0,N.N)();return(0,v.jsxs)("div",{className:O.container,children:[(0,v.jsx)(V,{handleRefresh:i}),(0,v.jsx)(F,{currentPath:o,onNavigate:c}),l?(0,v.jsx)(s.Suspense,{fallback:(0,v.jsx)("div",{children:"Loading..."}),children:(0,v.jsx)(re,{error:l})}):(0,v.jsx)(se,{setPreviewItemPath:t,setDeleteItemPath:n}),e&&(0,v.jsx)(S,{previewItemPath:e}),a&&(0,v.jsx)(ne,{deleteItemPath:a,handleDelete:r})]})}},893:(e,t,a)=>{a.d(t,{U2:()=>d,Ji:()=>l,QF:()=>c,eC:()=>o});var s=a(392),n=a(524);const r=()=>{const e=(0,n.Ri)(n.v$)||"";return{[n.v$]:e}};var i=a(323);const l=async e=>{const t="".concat(s.BQ.url,"?path=").concat(e),a=await fetch(t);await(0,i.L)(a);const n=(await a.json()).data.data;return Array.isArray(n)?n:[n]},o=async e=>{let{file:t,directory:a,filename:n,commitMessage:l}=e;const o=new FormData;o.append("file",t),o.append("directory",a),o.append("filename",n),o.append("commit_message",l);const c=await fetch(s.sV.url,{method:s.sV.method,headers:r(),body:o});await(0,i.L)(c);return(await c.json()).data},c=async e=>{let{path:t,content:a,commitMessage:n,sha:l}=e;const o=await fetch(s.Yl.url,{method:s.Yl.method,headers:r(),body:JSON.stringify({path:t,content:a,commitMessage:n,sha:l})});await(0,i.L)(o);return(await o.json()).data},d=async e=>{let{path:t,message:a,sha:n}=e;const l=a||"Delete ".concat(t),o=await fetch(s.c8.url,{method:s.c8.method,headers:r(),body:JSON.stringify({path:t,commitMessage:l,sha:n})});await(0,i.L)(o)}}}]);
//# sourceMappingURL=209.a5f5445c.chunk.js.map